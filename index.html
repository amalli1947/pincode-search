<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>India PIN Code Search</title>

<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    background: #f5f5f5;
}

header {
    background: #0d6efd;
    color: white;
    padding: 15px;
    text-align: center;
    font-size: 22px;
    font-weight: bold;
}

.container {
    max-width: 800px;
    margin: 20px auto;
    background: white;
    padding: 20px;
    border-radius: 6px;
}

select, input, button {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    font-size: 16px;
}

button {
    background: #198754;
    color: white;
    border: none;
    cursor: pointer;
    border-radius: 4px;
}

button:hover {
    background: #146c43;
}

.result {
    margin-top: 15px;
    padding: 10px;
    background: #eef;
    border-radius: 4px;
}

.village {
    padding: 8px;
    border-bottom: 1px solid #ccc;
    cursor: pointer;
}

.village:hover {
    background: #ddd;
}
</style>
</head>

<body>

<header>üáÆüá≥ INDIA PIN CODE SEARCH</header>

<div class="container">

<h2>üìç Search by State ‚Üí District ‚Üí Village</h2>

<select id="stateSelect">
<option value="">Select State</option>
</select>

<select id="districtSelect" disabled>
<option value="">Select District</option>
</select>

<select id="villageSelect" disabled>
<option value="">Select Village</option>
</select>

<div id="dropdownResult" class="result"></div>

</div>

<script>
let allData = [];

// Load ALL Post Office data (India)
fetch("https://api.postalpincode.in/postoffice/India")
.then(res => res.json())
.then(data => {
    allData = data[0].PostOffice;
    loadStates();
});

function loadStates() {
    const states = [...new Set(allData.map(p => p.State))].sort();
    const stateSelect = document.getElementById("stateSelect");

    states.forEach(state => {
        stateSelect.innerHTML += `<option value="${state}">${state}</option>`;
    });
}

document.getElementById("stateSelect").addEventListener("change", function () {
    const districtSelect = document.getElementById("districtSelect");
    districtSelect.innerHTML = `<option value="">Select District</option>`;
    districtSelect.disabled = false;

    document.getElementById("villageSelect").disabled = true;

    const districts = [...new Set(
        allData
        .filter(p => p.State === this.value)
        .map(p => p.District)
    )].sort();

    districts.forEach(d => {
        districtSelect.innerHTML += `<option value="${d}">${d}</option>`;
    });
});

document.getElementById("districtSelect").addEventListener("change", function () {
    const villageSelect = document.getElementById("villageSelect");
    villageSelect.innerHTML = `<option value="">Select Village</option>`;
    villageSelect.disabled = false;

    const villages = allData.filter(p =>
        p.State === stateSelect.value &&
        p.District === this.value
    );

    villages.forEach(v => {
        villageSelect.innerHTML +=
        `<option value="${v.Name}|${v.Pincode}|${v.State}|${v.District}">
        ${v.Name}
        </option>`;
    });
});

document.getElementById("villageSelect").addEventListener("change", function () {
    const [name, pin, state, district] = this.value.split("|");
    const result = document.getElementById("dropdownResult");

    result.innerHTML = `
    <div class="village"
    onclick="openMap('${name}','${district}','${state}')">
    üè† <b>${name}</b><br>
    PIN: ${pin}<br>
    ${district}, ${state}
    </div>`;
});

function openMap(village, district, state) {
    const query = `${village}, ${district}, ${state}, India`;
    window.open(
        "https://www.google.com/maps/search/?api=1&query=" +
        encodeURIComponent(query),
        "_blank"
    );
}
</script>

</body>
</html>
